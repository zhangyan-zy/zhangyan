<?xml version="1.0" encoding="UTF-8"?>
		<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.wingscode.modules.common.dao.UserTestDao">

<select id="queryUserList" resultType="java.util.Map">
      SELECT
        count(*) sumLeads,
        u.username,
       (select count(*)
        from
      tb_leads l
      where DATE_FORMAT(l.gmt_creat,'%m-%d-%Y') = DATE_FORMAT(NOW(),'%m-%d-%Y') and  l.parent_id = u.user_id
       ) addLeads
      from sys_user u
      inner join tb_leads l ON u.user_id = l.parent_id
      inner join sys_user_role ur ON ur.user_id = u.user_id
      and ur.role_id = 4
      group  by
        u.user_id
      LIMIT 10
	</select>


	<select id="queryZxLeadersList" resultType="java.util.Map">
     select
	      count(*) esumLeads,
	      u.username workerName,
        (select username from sys_user u where u.user_id=l.parent_id ) ename,
        (
         select
          count(*)
          from
          tb_leads l
            where DATE_FORMAT(l.gmt_creat,'%m-%d-%Y') = DATE_FORMAT(NOW(),'%m-%d-%Y')  and  l.worker_id = u.user_id
  )  eaddleads
	from sys_user u
	    inner join tb_leads l on u.user_id=l.worker_id
	    inner JOIN sys_user_role ur ON ur.user_id = u.user_id
		AND ur.role_id = 5 group by u.user_id
		LIMIT 10
	</select>



	<select id="OrderAgentList" resultType="java.util.Map">
	select
	count(*) asumLeads,
	u.username aname,
	(
		select
			count(*)
		from
			tb_leads l
		where
			DATE_FORMAT(l.gmt_creat, '%m-%d-%Y') = DATE_FORMAT(NOW(), '%m-%d-%Y')
		and l.worker_id = u.user_id
	) aaddleads
      from
	sys_user u
      inner join tb_leads l ON u.user_id = l.worker_id
      inner join sys_user_role ur ON ur.user_id = u.user_id
      and ur.role_id = 5
      group by
      	u.user_id
      order by
      	asumLeads DESC
      LIMIT 10
      	</select>
</mapper>
